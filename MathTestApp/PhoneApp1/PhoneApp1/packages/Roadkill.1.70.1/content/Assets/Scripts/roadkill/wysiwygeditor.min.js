var Roadkill;(function(n){(function(n){var t=function(){function t(){}return t.prototype.bindEvents=function(){var t=this;$(".wysiwyg-bold").click(function(){t.addStyling(ROADKILL_EDIT_BOLD_TOKEN)}),$(".wysiwyg-italic").click(function(){t.addStyling(ROADKILL_EDIT_ITALIC_TOKEN)}),$(".wysiwyg-underline").click(function(){t.addStyling(ROADKILL_EDIT_UNDERLINE_TOKEN)}),$(".wysiwyg-h1").click(function(){t.addHeading(ROADKILL_EDIT_HEADING_TOKEN)}),$(".wysiwyg-h2").click(function(){t.addHeading(t.repeat(ROADKILL_EDIT_HEADING_TOKEN,2))}),$(".wysiwyg-h3").click(function(){t.addHeading(t.repeat(ROADKILL_EDIT_HEADING_TOKEN,3))}),$(".wysiwyg-h4").click(function(){t.addHeading(t.repeat(ROADKILL_EDIT_HEADING_TOKEN,4))}),$(".wysiwyg-h5").click(function(){t.addHeading(t.repeat(ROADKILL_EDIT_HEADING_TOKEN,5))}),$(".wysiwyg-bullets").click(function(){t.addListItem(ROADKILL_EDIT_BULLETLIST_TOKEN)}),$(".wysiwyg-numbers").click(function(){t.addListItem(ROADKILL_EDIT_NUMBERLIST_TOKEN)}),$(".wysiwyg-picture").click(function(){n.Dialogs.openImageChooserModal("<iframe src='"+ROADKILL_FILESELECTURL+"' id='filechooser-iframe'><\/iframe>")}),$(".wysiwyg-link").click(function(){t.addLink()}),$(".wysiwyg-help").click(function(){n.Dialogs.openMarkupHelpModal("<iframe src='"+ROADKILL_WIKIMARKUPHELP+"' id='help-iframe'><\/iframe>")})},t.prototype.addStyling=function(n){var t=$("#Content").getSelection(),i;t!==null&&(i=$("#Content").val(),i.substr(t.start-2,2)!==n&&t.text.substr(0,2)!==n?($("#Content").replaceSelection(n+t.text+n),$("#Content").setSelection(t.end+2,t.end+2)):$("#Content").setSelection(t.end,t.end))},t.prototype.addHeading=function(n){var t=$("#Content").getSelection(),i;t!==null&&(i=t.text,t.text===""&&(i="Your heading"),$("#Content").replaceSelection("\n"+n+i+n+"\n"),$("#Content").setSelection(t.end,t.end))},t.addImage=function(t){var u=$("#Content").getSelection(),f,i,r;u!==null&&(f=u.text,u.text===""&&(f=ROADKILL_EDIT_IMAGE_TITLE),i=ROADKILL_EDIT_IMAGE_STARTTOKEN.toString(),i=i.replace("%ALT%",f),i=i.replace("%FILENAME%",t),r=ROADKILL_EDIT_IMAGE_ENDTOKEN.toString(),r=r.replace("%ALT%",f),r=r.replace("%FILENAME%",t),$("#Content").replaceSelection(i+r),$("#Content").setSelection(u.start+i.length,u.start+i.length),n.Dialogs.closeImageChooserModal())},t.prototype.addLink=function(){var i=$("#Content").getSelection(),r,n,t;i!==null&&(r=i.text,i.text===""&&(r=ROADKILL_EDIT_LINK_TEXTPLACEHOLDER),n=ROADKILL_EDIT_LINK_STARTTOKEN.toString(),n=n.replace("%URL%",ROADKILL_EDIT_LINK_URLPLACEHOLDER),n=n.replace("%LINKTEXT%",r),t=ROADKILL_EDIT_LINK_ENDTOKEN.toString(),t=t.replace("%URL%",ROADKILL_EDIT_LINK_URLPLACEHOLDER),t=t.replace("%LINKTEXT%",r),$("#Content").replaceSelection(n+t),$("#Content").setSelection(i.start+n.length,i.start+n.length))},t.prototype.addListItem=function(n){var t=$("#Content").getSelection(),r,i,u,f;if(t!==null){if(r=$("#Content").val(),i=t.start,i>0&&(i-=1),u=r.substr(i,1),f=r.substr(t.start,1),f===n){$("#Content").setSelection(t.end+2,t.end+2);return}u=="\n"||u==""?($("#Content").replaceSelection(t.text+n+" "),$("#Content").setSelection(t.end+2,t.end+2)):($("#Content").replaceSelection(t.text+"\n"+n+" "),$("#Content").setSelection(t.end+3,t.end+3))}},t.prototype.repeat=function(n,t){return new Array(t+1).join(n)},t}();n.WysiwygEditor=t})(n.Site||(n.Site={}));var t=n.Site})(Roadkill||(Roadkill={}))